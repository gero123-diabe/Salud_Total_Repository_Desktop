<!-- SaludTotal.Desktop/MainWindow.xaml -->
<Window x:Class="SaludTotal.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SaludTotal.Desktop"
        mc:Ignorable="d"
        Title="Gestión de Turnos - Salud Total" Height="600" Width="900" WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Fila para el título -->
            <RowDefinition Height="*"/>
            <!-- Fila para el DataGrid, ocupa todo el espacio disponible -->
            <RowDefinition Height="Auto"/>
            <!-- Fila para los botones -->
        </Grid.RowDefinitions>

        <!-- Título de la ventana -->
        <TextBlock Grid.Row="0" Text="Listado de Turnos" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>

        <!-- El DataGrid que mostrará los turnos -->
        <DataGrid Grid.Row="1" 
                  x:Name="TurnosDataGrid"
                  ItemsSource="{Binding Turnos}" 
                  SelectedItem="{Binding TurnoSeleccionado, Mode=TwoWay}"
                  AutoGenerateColumns="False" 
                  IsReadOnly="True" 
                  CanUserAddRows="False"
                  FontSize="14">

            <DataGrid.Columns>
                <!-- Las columnas se enlazan a propiedades del objeto Turno -->
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                <DataGridTextColumn Header="Fecha y Hora" Binding="{Binding Fecha, StringFormat='dd/MM/yyyy HH:mm'}" Width="*"/>
                <DataGridTextColumn Header="Estado" Binding="{Binding Estado}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- Para objetos anidados, usamos la notación de punto -->
                <DataGridTextColumn Header="Paciente" Binding="{Binding Paciente.NombreCompleto}" Width="2*"/>
                <DataGridTextColumn Header="Profesional" Binding="{Binding Profesional.NombreCompleto}" Width="2*"/>
            </DataGrid.Columns>

        </DataGrid>

        <!-- Indicador de Carga (Overlay) -->
        <Border Grid.Row="1" Background="#80FFFFFF" Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="Cargando datos..." FontSize="18" FontWeight="SemiBold"/>
                <ProgressBar IsIndeterminate="True" Width="200" Margin="0,10,0,0"/>
            </StackPanel>
        </Border>

        <!-- Panel de Botones de Acción -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Confirmar Turno" Width="150" Height="35" Margin="5" Click="ConfirmarTurno_Click"/>
            <Button Content="Cancelar Turno" Width="150" Height="35" Margin="5" Click="CancelarTurno_Click" Background="#FFE08282" Foreground="White"/>
            <Button Content="Nuevo Turno" Width="150" Height="35" Margin="5" Background="#FF87C5A3"/>
        </StackPanel>
    </Grid>
</Window>